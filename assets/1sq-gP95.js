import{_ as R,E as V,r as h,e as M,f as $,c as p,h as C,o as g,a,t as b,l as O,j as x,d as N,G as T,H as G,D as j,n as D,I as W,k as q,A as F,g as X,F as Q,i as K}from"./D8UeIOdY.js";import{s as z}from"./x_rD_Ya3.js";const J={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Y={class:"bg-white p-6 rounded-lg max-w-md w-full mx-4"},Z={key:0,class:"mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded"},ee={key:1,class:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded"},te={class:"mt-1 text-xs text-gray-500"},se={key:0},ae={key:0,class:"mt-1 text-sm text-red-500"},oe={class:"space-y-3"},ne={class:"flex items-start gap-3 cursor-pointer"},re={class:"flex items-start gap-3 cursor-pointer"},le=["disabled"],ie={__name:"WaitlistForm",props:{isOpen:Boolean},emits:["close","success"],setup(H,{emit:E}){const k=E,e=V({companyName:"",industry:"",customIndustry:"",name:"",email:"",phone:"",message:"",agreement1:!1,agreement2:!1}),y=h(""),f=h(!1),d=h(!1),v=h(!1),S=h(!1),A=h("");M(()=>{if(typeof window>"u")return!1;try{return!window.location.hostname.includes("localhost")&&!window.location.hostname.includes("127.0.0.1")&&!window.location.hostname.includes("0.0.0.0")}catch{return!1}}),M(()=>{if(typeof window>"u")return!1;try{return window.location.hostname==="emiratesfashionweeks.com"}catch{return!1}});const _=M(()=>e.companyName.trim()?e.companyName.trim().split(" ").map(o=>{if(o.length<=2)return o;const m=o[0],u=o[o.length-1],c="*".repeat(o.length-2);return m+c+u}).join(" "):"B**** ***n LLC"),I=s=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),P=s=>{if(!s||s.length<=2)return s;const t=s.split(" ");if(t.length===1){const o=t[0];return o.length<5?o.substring(0,2)+"*".repeat(o.length-2):o.substring(0,2)+"*".repeat(o.length-5)+o.substring(o.length-3)}else return t.map((m,u)=>u===0?m.substring(0,2)+"*".repeat(m.length-2):u===t.length-1&&m.length===3?m:"*".repeat(m.length)).join(" ")},B=s=>{console.log("reCAPTCHA success, token:",s),S.value=!0},w=()=>{if(console.log("Loading reCAPTCHA v3..."),!(typeof window>"u"))if(window.grecaptcha)console.log("reCAPTCHA already loaded, executing..."),window.grecaptcha.ready(()=>{console.log("reCAPTCHA ready (already loaded), executing...");try{window.grecaptcha.execute("6Le9rMYrAAAAAHyXSxhlpMSqCfXlxRDz69h_dldu",{action:"submit"}).then(s=>{console.log("reCAPTCHA executed (already loaded), token received"),B(s)}).catch(s=>{console.error("reCAPTCHA execute error (already loaded):",s)})}catch(s){console.error("reCAPTCHA v3 error (already loaded):",s)}});else{console.log("reCAPTCHA not loaded, loading script...");const s=document.createElement("script");s.src="https://www.google.com/recaptcha/api.js?render=6Le9rMYrAAAAAHyXSxhlpMSqCfXlxRDz69h_dldu",s.async=!0,s.defer=!0,document.head.appendChild(s),s.onload=()=>{console.log("reCAPTCHA script loaded"),window.grecaptcha&&window.grecaptcha.ready(()=>{console.log("reCAPTCHA ready, executing...");try{window.grecaptcha.execute("6Le9rMYrAAAAAHyXSxhlpMSqCfXlxRDz69h_dldu",{action:"submit"}).then(t=>{console.log("reCAPTCHA executed, token received"),B(t)}).catch(t=>{console.error("reCAPTCHA execute error:",t)})}catch(t){console.error("reCAPTCHA v3 error:",t)}})}}},l=()=>{e.industry!=="other"&&(e.customIndustry="")},n=()=>{if(d.value){k("close"),d.value=!1;return}if(k("close"),e.companyName="",e.industry="",e.customIndustry="",e.name="",e.email="",e.phone="",e.message="",e.agreement1=!1,e.agreement2=!1,y.value="",d.value=!1,v.value=!1,S.value=!1,typeof window<"u"&&window.grecaptcha){const s=document.getElementById("recaptcha-container");s&&(s.innerHTML="",q(()=>{w()}))}},r=async()=>{if(y.value="",!!e.companyName.trim()&&e.industry&&!(e.industry==="other"&&!e.customIndustry.trim())&&!(!e.agreement1||!e.agreement2)){if(!e.email.trim()){y.value="Email is required";return}if(!I(e.email)){y.value="Please enter a valid email address";return}f.value=!0;try{const s=e.industry==="other"?e.customIndustry:e.industry,t=window.location.hostname.includes("localhost")||window.location.hostname.includes("127.0.0.1")||window.location.hostname.includes("0.0.0.0");console.log("Form submission - isLocal:",t),console.log("Form submission - hostname:",window.location.hostname);let o;if(t)console.log("Using local API endpoint"),o=await fetch("/api/waitlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyName:e.companyName,industry:s,name:e.name,email:e.email,phone:e.phone,message:e.message,agreement1:e.agreement1,agreement2:e.agreement2})});else{console.log("Using Google Apps Script endpoint");const c="https://script.google.com/macros/s/AKfycby-9k6uo_l1HnNVUXBC3cmyEgtwb6EJBe7kRnbQ07QKlXLeNMk2QAQoKDUismUx1_DdlQ/exec",i=new URLSearchParams;i.append("action","submit"),i.append("companyName",e.companyName),i.append("industry",s),i.append("name",e.name),i.append("email",e.email),i.append("phone",e.phone),i.append("message",e.message),i.append("agreement1",e.agreement1.toString()),i.append("agreement2",e.agreement2.toString()),i.append("timestamp",new Date().toISOString()),i.append("source","Waitlist Form");const L=new Image,U=`${c}?${i.toString()}`;console.log("Sending to Google Apps Script:",U),L.src=U,L.onload=()=>{console.log("Image loaded successfully - data sent to Google Sheets")},L.onerror=()=>{console.log("Image failed to load - possible error sending data")},o={ok:!0,status:200}}if(t&&!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const m=P(e.companyName);A.value=`${m} has been successfully added to the waitlist!`,d.value=!0;const u={companyName:e.companyName,industry:s,timestamp:new Date().toISOString()};k("success",u),e.companyName="",e.industry="",e.customIndustry="",e.name="",e.email="",e.phone="",e.message="",e.agreement1=!1,e.agreement2=!1,setTimeout(()=>{d.value=!1,k("close")},3e3)}catch(s){console.error("Error adding to waitlist:",s),v.value=!0,setTimeout(()=>{v.value=!1},3e3)}finally{f.value=!1}}};return $(()=>{S.value=!0}),(s,t)=>H.isOpen?(g(),p("div",J,[a("div",Y,[a("div",{class:"flex justify-between items-center mb-6"},[t[8]||(t[8]=a("h3",{class:"text-xl font-semibold"},"Join Waitlist",-1)),a("button",{onClick:n,class:"text-gray-500 hover:text-gray-700 text-2xl leading-none"}," × ")]),d.value?(g(),p("div",Z,[a("p",null,b(A.value),1)])):C("",!0),v.value?(g(),p("div",ee,t[9]||(t[9]=[a("p",null,"An error occurred while adding you to the waitlist. Please try again later.",-1)]))):C("",!0),d.value?C("",!0):(g(),p("form",{key:2,onSubmit:O(r,["prevent"]),class:"space-y-4"},[a("div",null,[t[10]||(t[10]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[N("Company Name "),a("span",{class:"text-red-500"},"*")],-1)),x(a("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>e.companyName=o),type:"text",required:"",placeholder:"Beauty Salon LLC",class:"w-full text-black px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black placeholder:text-gray-400"},null,512),[[T,e.companyName]]),a("p",te," Your application will be displayed in the waitlist as "+b(_.value)+" / "+b(e.industry||"Sector"),1)]),a("div",null,[t[12]||(t[12]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[N("Industry / Sector "),a("span",{class:"text-red-500"},"*")],-1)),x(a("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.industry=o),onChange:l,class:"w-full text-black px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black"},t[11]||(t[11]=[j('<option value="" disabled style="color:#9ca3af;" data-v-bb00e580>Select your industry</option><option value="Medical &amp; Aesthetic Clinics" data-v-bb00e580>Medical &amp; Aesthetic Clinics</option><option value="Health &amp; Wellness Tourism / Nutrition" data-v-bb00e580>Health &amp; Wellness Tourism / Nutrition</option><option value="Beauty &amp; Cosmetics Brands" data-v-bb00e580>Beauty &amp; Cosmetics Brands</option><option value="Makeup Artists / Nails / Brows / Lashes" data-v-bb00e580>Makeup Artists / Nails / Brows / Lashes</option><option value="Salons, Spas &amp; Massage Studios" data-v-bb00e580>Salons, Spas &amp; Massage Studios</option><option value="Barbershops &amp; Grooming Services" data-v-bb00e580>Barbershops &amp; Grooming Services</option><option value="Gyms &amp; Fitness / Wellness Studios" data-v-bb00e580>Gyms &amp; Fitness / Wellness Studios</option><option value="Bridal &amp; Wedding Beauty Services" data-v-bb00e580>Bridal &amp; Wedding Beauty Services</option><option value="Makeup &amp; Cosmetology Schools / Courses" data-v-bb00e580>Makeup &amp; Cosmetology Schools / Courses</option><option value="Beauty Tech (CRM, Booking, Payments)" data-v-bb00e580>Beauty Tech (CRM, Booking, Payments)</option><option value="Salon &amp; Clinic Equipment Suppliers" data-v-bb00e580>Salon &amp; Clinic Equipment Suppliers</option><option value="other" data-v-bb00e580>Other</option>',13)]),544),[[G,e.industry]])]),e.industry==="other"?(g(),p("div",se,[t[13]||(t[13]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Specify Industry",-1)),x(a("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.customIndustry=o),type:"text",required:"",placeholder:"Specify your industry",class:"w-full text-black px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black placeholder:text-gray-400"},null,512),[[T,e.customIndustry]])])):C("",!0),a("div",null,[t[14]||(t[14]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},[N("Email "),a("span",{class:"text-red-500"},"*")],-1)),x(a("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>e.email=o),type:"email",required:"",placeholder:"mail@company.com",class:D(["w-full px-3 py-2 text-black border rounded-md focus:outline-none focus:ring-2 focus:ring-black placeholder:text-gray-400",y.value?"border-red-500":"border-gray-300"])},null,2),[[T,e.email]]),y.value?(g(),p("p",ae,b(y.value),1)):C("",!0)]),a("div",null,[t[15]||(t[15]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Whatsapp/Phone",-1)),x(a("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>e.phone=o),type:"tel",placeholder:"+971000000000",class:"w-full text-black px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black placeholder:text-gray-400"},null,512),[[T,e.phone]])]),a("div",null,[t[16]||(t[16]=a("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Referral Source & Comments to Organizers",-1)),x(a("textarea",{"onUpdate:modelValue":t[5]||(t[5]=o=>e.message=o),rows:"3",class:"w-full text-black px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-black placeholder:text-gray-400",placeholder:"How did you hear about us? Any additional comments..."},null,512),[[T,e.message]])]),a("div",oe,[a("label",ne,[x(a("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>e.agreement1=o),type:"checkbox",required:"",class:"mt-1 w-4 h-4 text-black bg-black border-black rounded focus:ring-black focus:ring-2"},null,512),[[W,e.agreement1]]),t[17]||(t[17]=a("span",{class:"text-sm text-gray-700"},[a("span",{class:"text-red-500"},"*"),N(" I understand that trial spots are limited and subsidized. Placement on the waitlist does not guarantee participation, and allocation will depend on availability. ")],-1))]),a("label",re,[x(a("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>e.agreement2=o),type:"checkbox",required:"",class:"mt-1 w-4 h-4 text-black bg-black border-black rounded focus:ring-black focus:ring-2"},null,512),[[W,e.agreement2]]),t[18]||(t[18]=a("span",{class:"text-sm text-gray-700"},[a("span",{class:"text-red-500"},"*"),N(" I agree that the EFW team may use my contact details to notify me about updates and opportunities. ")],-1))])]),a("button",{type:"submit",disabled:f.value||!e.companyName.trim()||!e.industry||!e.email.trim()||!e.agreement1||!e.agreement2,class:"w-full bg-black text-white py-2 rounded-md hover:bg-opacity-90 transition-colors disabled:bg-gray-400"},b(f.value?"Adding to Waitlist...":"Join"),9,le)],32))])])):C("",!0)}},_e=R(ie,[["__scopeId","data-v-bb00e580"]]),ce={class:"companies-list"},de={key:0,class:"text-center py-8"},ue={key:1,class:"text-center py-8"},me={class:"text-red-600"},pe={key:2,class:"text-center py-8"},ge={key:3,class:"space-y-3"},ye={class:"text-lg font-semibold mb-4"},fe={class:"space-y-3 pr-2"},he={class:"flex items-center gap-3 flex-1"},be={class:"flex-shrink-0 w-6 h-6 bg-gray-200 rounded-full flex items-center justify-center text-xs font-medium text-gray-600"},ve={class:"flex-1"},xe={class:"flex items-center gap-2"},we={class:"font-medium text-gray-900"},Ce={key:0,class:"px-2 py-1 text-xs font-semibold text-green-700 bg-green-100 rounded-full"},ke={__name:"CompaniesList",emits:["companies-count-updated"],setup(H,{expose:E,emit:k}){const e=h([]),y=h(!0),f=h(""),d=h(null),v=h(null),S=l=>{if(!l||l.length<=2)return l;const n=l.split(" ");if(n.length===1){const r=n[0];return r.length<5?r.substring(0,2)+"*".repeat(r.length-2):r.substring(0,2)+"*".repeat(r.length-5)+r.substring(r.length-3)}else return n.map((s,t)=>t===0?s.substring(0,2)+"*".repeat(s.length-2):t===n.length-1&&s.length===3?s:"*".repeat(s.length)).join(" ")},A=l=>d.value?l.companyName+"_"+l.timestamp===d.value:!1,_=l=>{console.log("CompaniesList: filtering companies:",l.length),console.log("CompaniesList: first company:",l[0]);const n=l.filter(r=>!r.status||r.status==="waitlist"||r.status==="Waitlist"||r.status==="");return console.log("CompaniesList: waitlist companies:",n.length),console.log("CompaniesList: waitlist companies:",n),n},I=async()=>{try{if(y.value=!0,f.value="",window.location.hostname.includes("localhost")||window.location.hostname.includes("127.0.0.1")||window.location.hostname.includes("0.0.0.0")){try{const n=await $fetch("/api/companies-list");if(n.success){const s=_(n.companies).sort((t,o)=>new Date(o.timestamp)-new Date(t.timestamp));if(d.value){const t=e.value.findIndex(o=>o.companyName+"_"+o.timestamp===d.value);if(t!==-1){const o=e.value.splice(t,1)[0];s.unshift(o)}}e.value=s,w("companies-count-updated",e.value.length)}else f.value=n.error||"Ошибка загрузки данных"}catch(n){console.error("API Error:",n),e.value=[],w("companies-count-updated",0),f.value="Сервис временно недоступен"}y.value=!1}else{const n="https://script.google.com/macros/s/AKfycby-9k6uo_l1HnNVUXBC3cmyEgtwb6EJBe7kRnbQ07QKlXLeNMk2QAQoKDUismUx1_DdlQ/exec",r="callback_companies_"+Date.now();window[r]=t=>{if(t&&t.success){const o=t.companies.map((c,i)=>({...c,status:c.status||(i<3?"approved":"waitlist")})),u=_(o).sort((c,i)=>new Date(i.timestamp)-new Date(c.timestamp));if(d.value){const c=e.value.findIndex(i=>i.companyName+"_"+i.timestamp===d.value);if(c!==-1){const i=e.value.splice(c,1)[0];u.unshift(i)}}e.value=u,w("companies-count-updated",e.value.length)}else f.value=t.error||"Ошибка загрузки данных";y.value=!1,delete window[r],document.head.removeChild(s)};const s=document.createElement("script");s.src=`${n}?action=getCompanies&callback=${r}`,document.head.appendChild(s)}}catch(l){console.error("Error fetching companies:",l),f.value="Ошибка загрузки данных",y.value=!1}},P=async()=>{try{const l="https://script.google.com/macros/s/AKfycbygds0XlVVKqRN56BVHo4S25BN96LRz8urJuur9crjlOR3lgYl__MHwrgu_GmKU_wjEPg/exec",n="callback_companies_auto_"+Date.now();window[n]=s=>{if(s&&s.success){const t=s.companies.map((u,c)=>({...u,status:u.status||(c<3?"approved":"waitlist")})),m=_(t).sort((u,c)=>new Date(c.timestamp)-new Date(u.timestamp));if(d.value){const u=e.value.findIndex(c=>c.companyName+"_"+c.timestamp===d.value);if(u!==-1){const c=e.value.splice(u,1)[0];m.unshift(c)}}e.value=m,w("companies-count-updated",e.value.length)}delete window[n],document.head.removeChild(r)};const r=document.createElement("script");r.src=`${l}?action=getCompanies&callback=${n}`,document.head.appendChild(r)}catch(l){console.error("Error during auto refresh:",l)}};E({refresh:async(l=null)=>{if(l){const n=l.companyName+"_"+l.timestamp;d.value=n,e.value.unshift(l)}await I()},fetchCompanies:I});const w=k;return F(e,l=>{w("companies-count-updated",l.length)},{immediate:!0}),$(()=>{I(),v.value=z(()=>{P()},6e4)}),X(()=>{v.value&&clearInterval(v.value)}),(l,n)=>(g(),p("div",ce,[y.value?(g(),p("div",de,n[0]||(n[0]=[a("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-black"},null,-1)]))):f.value?(g(),p("div",ue,[a("p",me,"Ошибка загрузки: "+b(f.value),1)])):e.value.length===0?(g(),p("div",pe,n[1]||(n[1]=[a("p",{class:"text-gray-600"},"Пока нет зарегистрированных компаний",-1)]))):(g(),p("div",ge,[a("h3",ye,"WAITLIST APPLICATIONS SUBMITTED ("+b(e.value.length)+")",1),a("div",fe,[(g(!0),p(Q,null,K(e.value,(r,s)=>(g(),p("div",{key:s,class:D(["flex items-center justify-between p-3 rounded-lg border transition-all duration-300",A(r)?"bg-green-50 border-green-200 shadow-md":"bg-gray-50 border-gray-200"])},[a("div",he,[a("div",be,b(s+1),1),a("div",ve,[a("div",xe,[a("div",we,b(S(r.companyName))+b(r.industry?" | "+r.industry:""),1),A(r)?(g(),p("span",Ce," NEW ")):C("",!0),n[2]||(n[2]=a("span",{class:"px-2 py-1 text-xs font-semibold text-orange-700 bg-orange-100 rounded-full"}," WAITLIST ",-1))])])])],2))),128))])]))]))}},Ie=R(ke,[["__scopeId","data-v-2aace707"]]),Ne=""+new URL("trial.DE43NbE_.webp",import.meta.url).href;export{Ie as C,Ne as I,_e as W};
