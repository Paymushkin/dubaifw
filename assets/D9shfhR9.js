import{s as P}from"./x_rD_Ya3.js";import{_ as E,r as m,f as O,g as G,A as K,c,o as d,a as l,t as h,F as M,i as S,n as j,h as Q}from"./BlP3RtZe.js";const z={class:"approved-companies-list"},L={key:0,class:"text-center py-8"},D={key:1,class:"text-center py-8"},W={class:"text-red-600"},q={key:2,class:"text-center py-8"},R={key:3,class:"space-y-3"},V={class:"text-lg font-semibold mb-4"},Z={class:"space-y-3 pr-2"},U={class:"flex items-center gap-3 flex-1"},X={class:"flex-shrink-0 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-xs font-medium text-white"},T={class:"flex-1"},F={class:"flex items-center gap-2"},J={class:"font-medium text-gray-900"},Y={key:0,class:"px-2 py-1 text-xs font-semibold text-green-700 bg-green-100 rounded-full"},B={__name:"ApprovedCompaniesList",emits:["companies-count-updated"],setup($,{expose:y,emit:C}){const i=m([]),v=m(!0),u=m(""),p=m(null),f=m(null),I=e=>{if(!e||e.length<=2)return e;const s=e.split(" ");if(s.length===1){const t=s[0];return t.length<5?t.substring(0,2)+"*".repeat(t.length-2):t.substring(0,2)+"*".repeat(t.length-5)+t.substring(t.length-3)}else return s.map((o,r)=>r===0?o.substring(0,2)+"*".repeat(o.length-2):r===s.length-1&&o.length===3?o:"*".repeat(o.length)).join(" ")},x=e=>e?e.companyName+"_"+e.timestamp===p.value:!1,w=e=>{console.log("ApprovedCompaniesList: filtering companies:",e.length),console.log("ApprovedCompaniesList: first company:",e[0]);const s=e.filter(t=>t.status==="approved"||t.status==="Approved");return console.log("ApprovedCompaniesList: approved companies:",s.length),console.log("ApprovedCompaniesList: approved companies:",s),s},_=async()=>{try{v.value=!0,u.value="";const e=window.location.hostname.includes("localhost")||window.location.hostname.includes("127.0.0.1")||window.location.hostname.includes("0.0.0.0");{const s="https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhWiUwXKPk7kgncE4AagO7hMUXjVl8o70kz2zaPb4ZkAJrpGFtjIeF2Z02I0QtIQSPefdmAjsjZmPowOGTLwez4aZTInT9iO0ykootspMOksfx1XghKc4nqqt3jI7WIxZY5heZvxMjO0LpQ1V4vzstEGxbhPgMGNtNePVzNnrWhBbhj5QdCnKZFotOc19drgnvKkqgEmMiQV3exOwEI7h1yzemJb2AMtrXsbcyxNWDTD3vqd-8d5KzuKnSWGnq3mNJS66n62wnRKbEyUK78xy4Qd3UomCFXY38INjtMp7VyMDDoQC6RwQheN7kvXg&lib=M_zsQqRJSebkGoYKGPSfga5UPGSN-xq4b",t="callback_approved_companies_"+Date.now();window[t]=r=>{if(r&&r.success){const b=r.companies.map((n,a)=>({...n,status:n.status||(a<3?"approved":"waitlist")})),g=w(b).sort((n,a)=>new Date(a.timestamp)-new Date(n.timestamp));if(p.value){const n=i.value.findIndex(a=>a.companyName+"_"+a.timestamp===p.value);if(n!==-1){const a=i.value.splice(n,1)[0];g.unshift(a)}}i.value=g,k("companies-count-updated",i.value.length)}else u.value=r.error||"Ошибка загрузки данных";v.value=!1,delete window[t],document.head.removeChild(o)};const o=document.createElement("script");o.src=`${s}?action=getCompanies&callback=${t}`,document.head.appendChild(o)}}catch(e){console.error("Error fetching approved companies:",e),u.value="Ошибка загрузки данных",v.value=!1}},N=async()=>{try{const e=window.location.hostname.includes("localhost")||window.location.hostname.includes("127.0.0.1")||window.location.hostname.includes("0.0.0.0");{const s="https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhWiUwXKPk7kgncE4AagO7hMUXjVl8o70kz2zaPb4ZkAJrpGFtjIeF2Z02I0QtIQSPefdmAjsjZmPowOGTLwez4aZTInT9iO0ykootspMOksfx1XghKc4nqqt3jI7WIxZY5heZvxMjO0LpQ1V4vzstEGxbhPgMGNtNePVzNnrWhBbhj5QdCnKZFotOc19drgnvKkqgEmMiQV3exOwEI7h1yzemJb2AMtrXsbcyxNWDTD3vqd-8d5KzuKnSWGnq3mNJS66n62wnRKbEyUK78xy4Qd3UomCFXY38INjtMp7VyMDDoQC6RwQheN7kvXg&lib=M_zsQqRJSebkGoYKGPSfga5UPGSN-xq4b",t="callback_approved_auto_"+Date.now();window[t]=r=>{if(r&&r.success){const b=r.companies.map((n,a)=>({...n,status:n.status||(a<3?"approved":"waitlist")})),g=w(b).sort((n,a)=>new Date(a.timestamp)-new Date(n.timestamp));i.value=g,k("companies-count-updated",i.value.length)}delete window[t],document.head.removeChild(o)};const o=document.createElement("script");o.src=`${s}?action=getCompanies&callback=${t}`,document.head.appendChild(o)}}catch(e){console.error("Error in auto refresh:",e)}};y({refresh:(e=null)=>{e&&(p.value=e.companyName+"_"+e.timestamp),_()},fetchCompanies:_});const k=C;return O(()=>{_(),f.value=P(N,3e4)}),G(()=>{f.value&&clearInterval(f.value)}),K(p,e=>{e&&setTimeout(()=>{p.value=null},5e3)}),(e,s)=>(d(),c("div",z,[v.value?(d(),c("div",L,s[0]||(s[0]=[l("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-black"},null,-1)]))):u.value?(d(),c("div",D,[l("p",W,"Ошибка загрузки: "+h(u.value),1)])):i.value.length===0?(d(),c("div",q,s[1]||(s[1]=[l("p",{class:"text-gray-600"},"Пока нет одобренных компаний",-1)]))):(d(),c("div",R,[l("h3",V,"APPROVED COMPANIES ("+h(i.value.length)+")",1),l("div",Z,[(d(!0),c(M,null,S(i.value,(t,o)=>(d(),c("div",{key:o,class:j(["flex items-center justify-between p-3 rounded-lg border transition-all duration-300",x(t)?"bg-green-50 border-green-200 shadow-md":"bg-blue-50 border-blue-200"])},[l("div",U,[l("div",X,h(o+1),1),l("div",T,[l("div",F,[l("div",J,h(I(t.companyName))+h(t.industry?" | "+t.industry:""),1),x(t)?(d(),c("span",Y," NEW ")):Q("",!0),s[2]||(s[2]=l("span",{class:"px-2 py-1 text-xs font-semibold text-blue-700 bg-blue-100 rounded-full"}," APPROVED ",-1))])])])],2))),128))])]))]))}},oe=E(B,[["__scopeId","data-v-65891959"]]);export{oe as A};
