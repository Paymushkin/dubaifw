<template>
  <div>
    <AppSeo
      title="AI Advertising Contest - Emirates Fashion Week Dubai 2025"
      description="Join the AI Advertising Contest for Emirates Fashion Week Spring/Summer 2025/2026. Create Instagram Reels and Stories using AI tools. Win prizes and contracts!"
      keywords="AI Advertising Contest, Emirates Fashion Week, Dubai Fashion Event, AI tools, Instagram Reels, Fashion Week 2025"
    />

    <div class="container mx-auto px-4 py-8">
      <!-- Секция 1: Заголовок и описание -->
      <section class="md:mb-[76px] mb-[56px]">
        <h1 class="text-2xl md:text-4xl lg:text-5xl font-bold mb-8 text-left">
          Emirates Fashion Week – AI Advertising Contest
        </h1>

        <div class="max-w-4xl">
          <p class="text-sm md:text-base xl:text-lg leading-relaxed text-left">
            We are excited to launch the <strong>AI Advertising Contest</strong> for the upcoming 
            <strong>14th&nbspEmirates Fashion Week, Spring/Summer&nbsp2025/2026</strong>,<br> taking place
            <strong>8–1&nbsp1&nbsp;November&nbsp;2025 in&nbsp;Dubai</strong>.
          </p>
        </div>
      </section>

      <!-- Секция 2: Информационные блоки -->
      <section class="md:mb-[76px] mb-[56px]">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          
          <!-- Блок 1: Who can participate? -->
          <div class="bg-white rounded-2xl p-6 shadow-lg">
            <h3 class="text-base md:text-xl xl:text-2xl font-bold mb-4">Who can participate</h3>
            <p class="text-sm md:text-base xl:text-lg mb-4">
              Anyone, anywhere. Use <strong>any AI tools</strong> to create <strong>Instagram Reels/Stories</strong> (video-editing allowed).
            </p>
            
            <h4 class="text-sm md:text-base xl:text-lg font-semibold mb-2"><strong>Requirements</strong></h4>
            <ul class="text-sm md:text-base xl:text-lg space-y-2">
              <li>• <strong>Format:</strong> 9:16 vertical</li>
              <li>• <strong>Duration:</strong> any for Reels/Stories</li>
              <li>• <strong>Must include date & EFW brand:</strong> <strong>8–11&nbsp;November&nbsp;2025, Dubai&nbsp;+ Emirates&nbsp;Fashion&nbsp;Week</strong> (Dr&nbsp;Sugiyama&nbsp;preferred)</li>
            </ul>
          </div>

          <!-- Блок 2: How to submit -->
          <div class="bg-white rounded-2xl p-6 shadow-lg">
            <h3 class="text-base md:text-xl xl:text-2xl font-bold mb-4">How to submit</h3>
            <ol class="text-sm md:text-base xl:text-lg space-y-2 mb-4">
              <li>1. Post your Reels/Story on your Instagram.</li>
              <li>2. Tag <strong>@emirates_fashionweek</strong> (not a collaboration—just a tag).</li>
              <li>3. Entries <strong>accepted only if reposted</strong> by our official account.</li>
            </ol>
            <div class="p-4 bg-yellow-50 border-l-4 border-yellow-400">
              <h4 class="text-sm md:text-base xl:text-lg font-semibold text-yellow-800 mb-2"><strong>Fake Account Alert</strong></h4>
              <p class="text-sm md:text-base xl:text-lg text-yellow-700">
                We detected a <strong>fake account</strong> using our name and unclear activity. Tag <strong>only</strong> the official: <strong>@emirates_fashionweek</strong> (black logo + blue verified sign).
              </p>
            </div>
          </div>

          <!-- Блок 3: Optional -->
          <div class="bg-white rounded-2xl p-6 shadow-lg">
            <h3 class="text-base md:text-xl xl:text-2xl font-bold mb-4">OPTIONAL</h3>
            <ul class="text-sm md:text-base xl:text-lg space-y-2">
              <li>• May use past EFW looks/highlights <a href="https://emiratesfashionweeks.com/gallery" class="text-blue-600 underline" target="_blank">emiratesfashionweeks.com/gallery</a> and designers' looks.</li>
              <li>• May use program note: <strong>8–9&nbsp;Nov</strong> Catwalk&nbsp;Runway · <strong>10–11&nbsp;Nov</strong> Pop-up&nbsp;Market (Beauty&nbsp;& Wellness).</li>
              <li>• <strong>Face of EFW:</strong> you may use faces listed in the authorized pool; the list will expand over time.</li>
              <li>• <strong>Reference assets below:</strong> venue/location photos and Faces of EFW images are provided as <strong>optional</strong> references. <strong>You do not have to use any or all</strong> of them — your creativity is not restricted.</li>
            </ul>
          </div>

          <!-- Блок 4: Prizes -->
          <div class="bg-white rounded-2xl p-6 shadow-lg">
            <h3 class="text-base md:text-xl xl:text-2xl font-bold mb-4">Prizes (Prize Stack)</h3>
            <p class="text-sm md:text-base xl:text-lg mb-3">Winners may receive:</p>
            <ul class="text-sm md:text-base xl:text-lg space-y-2">
              <li>• <strong>Contract</strong> for ongoing AI ads with Emirates Fashion Week.</li>
              <li>• <strong>Annual AI-tool fee coverage:</strong> $500 / $200 / $100.</li>
              <li>• <strong>Official recommendation letters</strong> confirming use in EFW media.</li>
              <li>• <strong>Potential paid contracts</strong> with participating designers (up to <strong>40</strong>) for AI ads of their looks.</li>
              <li>• <strong>Screening</strong> on giant LED screens during Fashion Week.</li>
              <li>• <strong>LinkedIn-ready badge</strong> confirming participation in the EFW campaign.</li>
              <li>• <strong>Featured website gallery</strong> with credits and links.</li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Секция 3: Reels -->
      <section class="md:mb-[76px] mb-[56px]">
        <h2 class="text-2xl md:text-3xl font-bold text-left mb-8">Reels</h2>
        
        <!-- Instagram Reel -->
        <div class="mb-8">
          <div class="bg-white rounded-2xl p-6 shadow-lg text-center">
            <h3 class="text-lg font-semibold mb-4">Instagram Reel</h3>
            <a 
              href="https://www.instagram.com/reel/DI545tgzR60/" 
              target="_blank" 
              class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-300"
            >
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
              </svg>
              View on Instagram
            </a>
          </div>
        </div>
        
        <!-- Карусель видео из Google Sheets -->
        <div v-if="reelsVideos.length > 0">
          <ReelsCarousel :videos="reelsVideos" />
        </div>
      </section>

      <!-- Секция 4: Галерея изображений -->
      <section class="md:mb-[76px] mb-[56px]">
        <h2 class="text-2xl md:text-3xl font-bold text-left mb-8">Optional Reference Gallery</h2>
        
        <!-- Masonry сетка для десктопа, горизонтальный скролл для мобильных -->
        <!-- Мобильная версия - горизонтальный скролл -->
        <div class="block sm:hidden">
          <div class="overflow-x-auto hide-scrollbar -mx-4">
            <div class="flex gap-4 px-4 pb-4">
              <div 
                v-for="(image, index) in galleryImages" 
                :key="index"
                class="flex-shrink-0 h-48 overflow-hidden transition-all duration-300 group"
              >
                <img 
                  :src="image" 
                  :alt="`AI Contest Photo ${index + 1}`"
                  class="h-full w-auto max-w-[80vw] object-contain hover:scale-105 transition-transform duration-300 cursor-pointer"
                  @click="openImageModal(image)"
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Десктопная версия - masonry сетка -->
        <div class="hidden sm:block">
          <div class="columns-1 sm:columns-2 lg:columns-3 xl:columns-4 gap-4 space-y-4">
            <div 
              v-for="(image, index) in galleryImages" 
              :key="index"
              class="break-inside-avoid"
            >
              <img 
                :src="image" 
                :alt="`AI Contest Photo ${index + 1}`"
                class="w-full h-auto rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 cursor-pointer"
                @click="openImageModal(image)"
              >
            </div>
          </div>
        </div>
      </section>

      <!-- Секция 5: Скачивание шрифта -->
      <section class="mb-8 md:mb-[76px] mb-[56px]">
        <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl p-8 text-center">
        <h2 class="text-2xl md:text-3xl font-bold mb-4">Download Font</h2>
        <p class="text-base md:text-lg mb-6 text-gray-700">
          Use the official Dr Sugiyama font for your contest entries to match the Emirates Fashion Week branding.
        </p>
        <a 
          href="https://storage.yandexcloud.net/videos-meyou/efw2025/ai/DrSugiyama-Regular.ttf"
          download="DrSugiyama-Regular.ttf"
          class="inline-flex items-center px-6 py-3 bg-purple-600 text-white font-semibold rounded-lg hover:bg-purple-700 transition-colors duration-300"
        >
          <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
          </svg>
          Download
        </a>
        </div>
      </section>

      <!-- Секция 6: Face of EFW -->
      <section class="md:mb-[76px] mb-[56px]">
        <h2 class="text-2xl md:text-3xl font-bold text-left mb-8">Face of EFW</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="bg-white rounded-2xl p-6 shadow-lg">
            <img 
              src="https://storage.yandexcloud.net/videos-meyou/efw2025/ai/item-1.jpg" 
              alt="Face of EFW 1"
              class="w-full h-auto rounded-lg object-cover"
            >
          </div>
          
          <div class="bg-white rounded-2xl p-6 shadow-lg">
            <img 
              src="https://storage.yandexcloud.net/videos-meyou/efw2025/ai/item-1.jpg" 
              alt="Face of EFW 2"
              class="w-full h-auto rounded-lg object-cover"
            >
          </div>
        </div>
      </section>
    </div>
    

    <!-- Модальное окно для просмотра изображений -->
    <div 
      v-if="selectedImage" 
      class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4"
      @click="closeImageModal"
    >
      <div class="relative max-w-4xl max-h-full">
        <button 
          @click="closeImageModal"
          class="absolute top-4 right-4 text-white text-2xl font-bold bg-black bg-opacity-50 rounded-full w-10 h-10 flex items-center justify-center hover:bg-opacity-75"
        >
          ×
        </button>
        <img 
          :src="selectedImage" 
          alt="Gallery Image"
          class="max-w-full max-h-full object-contain rounded-lg"
          @click.stop
        >
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import AppSeo from '@/components/AppSeo.vue'
import ReelsCarousel from '@/components/ReelsCarousel.vue'

definePageMeta({
  layout: 'default'
})

// Генерируем массив URL изображений от photo-ai-1.png до photo-ai-19.png
const galleryImages = ref([])
const selectedImage = ref(null)
const reelsVideos = ref([])

// Создаем массив URL для галереи
for (let i = 1; i <= 19; i++) {
  galleryImages.value.push(`https://storage.yandexcloud.net/videos-meyou/efw2025/ai/photo-ai-${i}.png`)
}

// Функция для загрузки видео из Google Sheets
const fetchReelsVideos = async () => {
  try {
    // Определяем, работаем ли мы локально или на продакшене
    const isLocal = window.location.hostname.includes('localhost') ||
                   window.location.hostname.includes('127.0.0.1') ||
                   window.location.hostname.includes('0.0.0.0');

    if (isLocal) {
      // Локально используем API
      const response = await $fetch('/api/reels', {
        query: { _t: Date.now() } // Добавляем timestamp для предотвращения кеширования
      });
      if (response.success) {
        reelsVideos.value = response.videos || [];
      }
    } else {
      // На продакшене (GitHub Pages) используем прямые запросы к Google Sheets
      const SPREADSHEET_ID = '12hBjIa1dMRgX7nVGBMvoAK_1d3Nxl4K-Gi0z9TIB4dQ';
      const CSV_URL = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/export?format=csv&gid=0`;

      const response = await fetch(CSV_URL);

      if (!response.ok) {
        throw new Error(`CSV export error: ${response.statusText}`);
      }

      const csvText = await response.text();

      // Парсим CSV правильно (учитывая запятые в кавычках)
      const lines = csvText.split('\n');
      const rows = lines.filter(line => line.trim()).map(line => {
        const values = [];
        let current = '';
        let inQuotes = false;

        for (let i = 0; i < line.length; i++) {
          const char = line[i];

          if (char === '"') {
            inQuotes = !inQuotes;
          } else if (char === ',' && !inQuotes) {
            values.push(current.trim());
            current = '';
          } else {
            current += char;
          }
        }

        values.push(current.trim());
        return values;
      });

      // Преобразуем в массив ссылок на видео
      const videoUrls = rows
        .map(row => row[0]?.trim()) // Берем первую колонку
        .filter(url => url && url.startsWith('http')) // Фильтруем только валидные URL
        .map(url => url.replace(/^"(.*)"$/, '$1')) // Убираем кавычки если есть
        .filter((url, index, array) => array.indexOf(url) === index); // Убираем дубликаты

      reelsVideos.value = videoUrls;
    }
  } catch (error) {
    console.error('Error fetching reels videos:', error);
    reelsVideos.value = [];
  }
};

// Функции для модального окна
const openImageModal = (imageSrc) => {
  selectedImage.value = imageSrc
}

const closeImageModal = () => {
  selectedImage.value = null
}

// Загружаем видео при монтировании компонента
onMounted(() => {
  fetchReelsVideos();
});
</script>

<style scoped>
/* Скрытие полосы прокрутки для горизонтального скролла */
.hide-scrollbar {
  scrollbar-width: none;  /* Firefox */
  -ms-overflow-style: none;  /* Internet Explorer 10+ */
}

.hide-scrollbar::-webkit-scrollbar {
  display: none;  /* Safari and Chrome */
}
</style>
